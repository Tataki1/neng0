<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>年号当てクイズ</title>
  <style>
    body { font-family: sans-serif; text-align: center; padding: 30px; }
    button, input { font-size: 18px; margin: 10px; }
  </style>
</head>
<body>
  <h1>年号当てクイズ</h1>

  <label>開始年：<input type="number" id="startYear" value="1800"></label>
  <label>終了年：<input type="number" id="endYear" value="2025"></label>
  <button onclick="generateQuestion()">出題する</button>

  <h2 id="question"></h2>
  <div id="answerButtons"></div>
  <button id="revealBtn" onclick="showAnswer()" style="display:none">答えを見る</button>
  <div id="answer" style="margin-top:20px; font-size: 24px;"></div>

  <script>
    const events = [
      { year: 1868, event: "明治維新" },
      { year: 1945, event: "第二次世界大戦終戦" },
      { year: 1923, event: "関東大震災" },
      { year: 1989, event: "平成時代開始" },
      { year: 2011, event: "東日本大震災" },
      { year: 1600, event: "関ヶ原の戦い" },
      { year: 1192, event: "鎌倉幕府成立" },
      { year: 710, event: "平城京遷都" },
      { year: 1543, event: "鉄砲伝来" },
      { year: 1575, event: "長篠の戦い" },
      { year: 1867, event: "大政奉還" },
      { year: 1941, event: "真珠湾攻撃" },
      { year: 1964, event: "東京オリンピック" },
      { year: 1603, event: "江戸幕府成立" },
      { year: 1871, event: "廃藩置県" },
      { year: 1889, event: "大日本帝国憲法発布" }
    ];

    let currentAnswer = null;

    function generateQuestion() {
      document.getElementById("answer").textContent = "";
      document.getElementById("revealBtn").style.display = "none";
      document.getElementById("revealBtn").textContent = "答えを見る";

      const start = parseInt(document.getElementById("startYear").value, 10);
      const end = parseInt(document.getElementById("endYear").value, 10);

      const filteredEvents = events.filter(e => e.year >= start && e.year <= end);
      if (filteredEvents.length < 4) {
        document.getElementById("question").textContent = "この範囲では選択肢が足りません。";
        document.getElementById("answerButtons").innerHTML = "";
        return;
      }

      const choices = [];
      while (choices.length < 4) {
        const pick = filteredEvents[Math.floor(Math.random() * filteredEvents.length)];
        if (!choices.includes(pick)) choices.push(pick);
      }

      const question = choices[Math.floor(Math.random() * choices.length)];
      currentAnswer = question;

      document.getElementById("question").textContent = `「${question.event}」が起きた年は？`;
      const shuffled = choices.map(c => c.year).sort(() => Math.random() - 0.5);

      document.getElementById("answerButtons").innerHTML = shuffled.map(year =>
        `<button onclick="selectAnswer(${year})">${year}</button>`
      ).join("");

      document.getElementById("revealBtn").style.display = "inline-block";
    }

    function selectAnswer(year) {
      const answer = document.getElementById("answer");
      if (year === currentAnswer.year) {
        answer.textContent = "正解！";
        answer.style.color = "green";
      } else {
        answer.textContent = `不正解！正解は ${currentAnswer.year} 年`;
        answer.style.color = "red";
      }
      document.getElementById("revealBtn").textContent = "次の問題へ";
    }

    function showAnswer() {
      if (document.getElementById("revealBtn").textContent === "次の問題へ") {
        generateQuestion();
      } else {
        document.getElementById("answer").textContent = `正解は ${currentAnswer.year} 年`;
        document.getElementById("answer").style.color = "black";
        document.getElementById("revealBtn").textContent = "次の問題へ";
      }
    }
  </script>
</body>
</html>
